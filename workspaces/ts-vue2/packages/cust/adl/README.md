# 🗓 排班表格组件使用文档

一个支持复制粘贴、撤销恢复、自动补休、动态天数与节假日高亮的高级排班表格组件。适合排班管理、出勤安排等使用场景。

---

## ✅ 核心功能

| 功能点            | 描述                                                                 |
| ----------------- | -------------------------------------------------------------------- |
| ⌨️ 单元格编辑     | 点击单元格进入下拉编辑，选择班次                                     |
| 📋 复制粘贴支持   | 鼠标框选区域后支持 `Ctrl/Cmd + C / V` 快捷键粘贴（Excel 风格）     |
| ↩️ 撤销/恢复      | 支持 `Ctrl/Cmd + Z` 撤销，`Ctrl/Cmd + Shift + Z` 恢复               |
| 📆 自动天数计算   | 根据 `year` 和 `month` 自动生成当月所有天数                         |
| 💤 夜班补休功能   | 选择夜班后，自动在右侧单元格填写“休息”                             |
| 🎨 自定义样式     | 支持配置每个班次的文字颜色和背景色                                 |
| 🗓 表头含星期     | 表头格式为「几日（星期X）」                                          |
| 🎉 节假日高亮     | 指定日期显示法定假日标签及自定义背景色                             |

---
 
## ⚙️ Props 配置项

| 参数名                     | 类型       | 默认值                 | 描述                                                           |
| -------------------------- | ---------- | ---------------------- | -------------------------------------------------------------- |
| `year`                     | Number     | 当前年份               | 年份（用于动态生成天数）                                       |
| `month`                    | Number     | 当前月份（1-12）       | 月份（用于动态生成天数）                                       |
| `names`                    | String[]   | `['张三','李四',…]`    | 表格行（员工/人员）名称列表                                   |
| `value`                    | String[][] | 自动生成的二维空数组   | 表格排班内容，支持 `v-model` 双向绑定                         |
| `options`                  | Object[]   | 示例见下               | 可选班次内容及其样式设置                                       |
| `nightShiftValue`          | String     | `'夜班'`               | 用于识别夜班，触发补休逻辑                                     |
| `restAfterNightShiftValue` | String     | `'休息'`               | 夜班后自动填写的休息文案                                       |
| `holidays`                 | Object     | `{"2025-05-01": "劳动节"}` | 指定节假日文案映射，Key 为日期字符串，Value 为节日名 |
| `holidayColor`             | String     | `#f44336`              | 节假日背景色，高亮表头使用                                     |

---

## 🎨 `options` 配置说明

每个班次支持自定义文本样式与背景色。

```js
[
  {
    label: '白班',
    value: '白班',
    color: '#000',
    background: '#fff'
  },
  {
    label: '夜班',
    value: '夜班',
    color: 'white',
    background: '#d32f2f'
  },
  {
    label: '休息',
    value: '休息',
    color: '#388e3c',
    background: '#e8f5e9'
  }
]
```

---

## 🔄 交互行为说明

| 行为           | 说明                                                                 |
| -------------- | -------------------------------------------------------------------- |
| 编辑           | 单击单元格进入编辑，下拉选择班次                                    |
| 夜班自动补休   | 选中“夜班”后，右侧单元格自动写入“休息”，即使已有内容也会覆盖       |
| 复制粘贴       | 框选单元格后 `Ctrl/Cmd + C` 复制，支持粘贴外部 Excel 文本            |
| 撤销/恢复      | 每次修改会推入撤销栈，支持快捷键 `Ctrl+Z` 和 `Ctrl+Shift+Z`          |
| 清除选区       | `Esc` 清除当前选区 / 编辑状态                                        |
| 节假日标记     | 表头可显示如“劳动节”文案，并应用背景高亮色                          |

---

## 💡 使用示例（低代码 JSON）

```json
{
  "type": "排班表格",
  "props": {
    "year": 2025,
    "month": 5,
    "names": ["阿狸", "提莫", "盖伦"],
    "nightShiftValue": "夜班",
    "restAfterNightShiftValue": "休息",
    "holidayColor": "#ff9800",
    "holidays": {
      "2025-05-01": "劳动节",
      "2025-05-05": "法定节假日"
    },
    "options": [
      { "label": "白班", "value": "白班", "color": "#000", "background": "#fff" },
      { "label": "夜班", "value": "夜班", "color": "white", "background": "#f44336" },
      { "label": "休息", "value": "休息", "color": "#388e3c", "background": "#e0f2f1" }
    ],
    "value": [
      ["白班", "夜班", "休息", "", "", "", ""],
      ["夜班", "休息", "", "", "", "", ""],
      ["", "", "", "", "", "", ""]
    ]
  }
}
```

---

## 🧷 注意事项

- `value` 必须为二维数组，行数与 `names.length` 保持一致。
- 节假日 key 的格式必须为 `YYYY-MM-DD`。
- 节假日文案为空时将不显示第三行文案。
- 自动补休逻辑固定为“右侧单元格”，若超出天数将忽略。
- 当前仅支持文字数据复制粘贴，暂不支持样式同步。

---

> 文档生成时间：2025-04-30
